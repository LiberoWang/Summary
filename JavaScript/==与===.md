```js
  // èµ·å› ï¼š
  ++[[]][+[]]+[+[]] == 10
```

```js
1. {} + {} //chrome:"[object Object][object Object]"ï¼ŒFirfox:NaN
2. {} + [] // 0 ?? => å˜å½¢ ï¼š({}) + [] => è¾“å‡º "[object Object]"
3. [] + {} //"[object Object]"
4. {} + 1 // 1 ??
5. ({} + 1) // "[object Object]1"
6. 1 + {} // "1[object Object]"
7. [] + 1 // 1
8. 1 + [] // 1
9. 1 - [] // 1
10. 1 - {} // NaN
11. 1 - !{} // 1
12. 1 + !{} // 1
13. 1 + "2" + "2" // 122
14. 1+ + "2" + "2" // 32 => ä¸€å…ƒ+è¿ç®—ç¬¦ä¼˜å…ˆçº§é«˜ + '2' => 2 => 1 + 2 => 3 => 3 + '2' => '32'
15. 1++"2"+"2" // æŠ¥é”™ => å‰ç¼€++æŠ¥é”™
16. []==![] // true
17. []===![] // false
```

#### ä¸€å…ƒ `+` å’Œ ä¸€å…ƒ `-` æ“ä½œç¬¦

[è§„èŒƒ](https://262.ecma-international.org/5.1/#sec-11.4.6)

> + UnaryExpression: +UnaryExpression

ä¸€å…ƒ + è¿ç®—ç¬¦å°†å…¶æ“ä½œæ•°è½¬æ¢ä¸º `Number` ç±»å‹ã€‚

1. Let expr be the result of evaluating UnaryExpression.
2. Return `ToNumber(GetValue(expr))`.

```js
var sNum = "20";
alert(typeof sNum); //è¾“å‡º "string"
var iNum = +sNum;
alert(typeof iNum); //è¾“å‡º "number"

// Number({}) => NaN
+{} // NaN
+[] // 0
+function() {} // NaN
```

> - UnaryExpression: -UnaryExpression

ä¸€å…ƒ - è¿ç®—ç¬¦å°†å…¶æ“ä½œæ•°è½¬æ¢ä¸º `Number` ç±»å‹ï¼Œç„¶åå°†å…¶å–åã€‚ è¯·æ³¨æ„ï¼Œ `+0` å–åä¼šäº§ç”Ÿ `-0`ï¼Œ`-0` å–åä¼šäº§ç”Ÿ`+0`ã€‚

1. Let expr be the result of evaluating UnaryExpression.
2. Let `oldValue` be `ToNumber(GetValue(expr))`.
3. If `oldValue` is `NaN`, return `NaN`.
4. Return the result of negating `oldValue`; that is, compute a Number with the same magnitude but opposite sign.

```js
var sNum = "20";
alert(typeof sNum); //è¾“å‡º "string"
var iNum = -sNum;
alert(iNum);        //è¾“å‡º "-20"
alert(typeof iNum); //è¾“å‡º "number"

-{} // NaN
-[] // -0
```

#### åŠ æ³•è¿ç®—ç¬¦ï¼ˆ+ï¼‰

[+è¿ç®—ç¬¦è§„èŒƒ](https://262.ecma-international.org/5.1/#sec-11.6.1)

åŠ æ³•è¿ç®—ç¬¦æ‰§è¡Œå­—ç¬¦ä¸²è¿æ¥æˆ–æ•°å­—åŠ æ³•ã€‚

**åœ¨å¤„ç†ç‰¹æ®Šå€¼æ—¶ï¼ŒECMAScript ä¸­çš„åŠ æ³•ä¹Ÿæœ‰ä¸€äº›ç‰¹æ®Šè¡Œä¸ºï¼š**

- æŸä¸ªè¿ç®—æ•°æ˜¯ `NaN`ï¼Œé‚£ä¹ˆç»“æœä¸º `NaN`ã€‚
- `-Infinity` åŠ  `-Infinity`ï¼Œç»“æœä¸º `-Infinity`ã€‚
- `Infinity` åŠ  `-Infinity`ï¼Œç»“æœä¸º `NaN`ã€‚
- `+0` åŠ  `+0`ï¼Œç»“æœä¸º `+0`ã€‚
- `-0` åŠ  `+0`ï¼Œç»“æœä¸º `+0`ã€‚
- `-0` åŠ  `-0`ï¼Œç»“æœä¸º `-0`ã€‚

ä¸è¿‡ï¼Œå¦‚æœæŸä¸ªè¿ç®—æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆé‡‡ç”¨ä¸‹åˆ—è§„åˆ™ï¼š

- å¦‚æœä¸¤ä¸ªè¿ç®—æ•°éƒ½æ˜¯å­—ç¬¦ä¸²ï¼ŒæŠŠç¬¬äºŒä¸ªå­—ç¬¦ä¸²è¿æ¥åˆ°ç¬¬ä¸€ä¸ªä¸Šã€‚
- å¦‚æœåªæœ‰ä¸€ä¸ªè¿ç®—æ•°æ˜¯å­—ç¬¦ä¸²ï¼ŒæŠŠå¦ä¸€ä¸ªè¿ç®—æ•°è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œç»“æœæ˜¯ä¸¤ä¸ªå­—ç¬¦ä¸²è¿æ¥æˆçš„å­—ç¬¦ä¸²ã€‚

```js
1 + '1' // 11 (string)
```

#### å‡æ³•è¿ç®—ç¬¦ï¼ˆ-ï¼‰

[-è¿ç®—ç¬¦è§„èŒƒ](https://262.ecma-international.org/5.1/#sec-11.6.2)

**å¤„ç†ç‰¹æ®Šå€¼æ—¶ï¼Œå‡æ³•è¿ç®—ç¬¦ä¹Ÿæœ‰ä¸€äº›ç‰¹æ®Šè¡Œä¸º:**

- æŸä¸ªè¿ç®—æ•°æ˜¯ NaNï¼Œé‚£ä¹ˆç»“æœä¸º NaNã€‚
- `Infinity` å‡ `Infinity`ï¼Œç»“æœä¸º `NaN`ã€‚
- `-Infinity` å‡ `-Infinity`ï¼Œç»“æœä¸º `NaN`ã€‚
- `Infinity` å‡ `-Infinity`ï¼Œç»“æœä¸º `Infinity`ã€‚
- `-Infinity` å‡ `Infinity`ï¼Œç»“æœä¸º `-Infinity`ã€‚
- `+0` å‡ `+0`ï¼Œç»“æœä¸º `+0`ã€‚
- `-0` å‡ `-0`ï¼Œç»“æœä¸º `-0`ã€‚
- `+0` å‡ `-0`ï¼Œç»“æœä¸º `+0`ã€‚
- æŸä¸ªè¿ç®—ç¬¦ä¸æ˜¯æ•°å­—ï¼Œé‚£ä¹ˆç»“æœä¸º NaNã€‚


#### ToNumber(x)

[è§„èŒƒå®šä¹‰](https://262.ecma-international.org/5.1/#sec-9.3)

![image](https://user-images.githubusercontent.com/25894364/125579402-6dfcfd84-1234-4a6b-b676-564b49acc0d5.png)

> String è½¬æˆ Numberæ¯”è¾ƒå¤æ‚ `(parseInt())`

#### ToPrimitive(x)

[è§„èŒƒå®šä¹‰](https://262.ecma-international.org/5.1/#sec-9.1)

> åŸå§‹å€¼(primitives) 

1. undefined
2. null
3. boolean
4. number
5. string

![image](https://user-images.githubusercontent.com/25894364/125580025-e5c47c7b-8bd1-4ffc-9366-2501f74ba2e3.png)


#### `[[DefaultValue]] (hint)`

[DefaultValue - è§„èŒƒå®šä¹‰](https://262.ecma-international.org/5.1/#sec-8.12.8)

> `ToPrimitive(goal, preferredType)`

JSå¼•æ“å†…éƒ¨è½¬æ¢ä¸ºåŸå§‹å€¼`ToPrimitive(goal, preferredType)`å‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ª`goal`ä¸ºè¢«è½¬æ¢çš„å¯¹è±¡ï¼Œç¬¬äºŒä¸ª`preferredType`ä¸ºå¸Œæœ›è½¬æ¢æˆçš„ç±»å‹ï¼ˆé»˜è®¤ä¸ºç©ºï¼Œæ¥å—çš„å€¼ä¸º`Number`æˆ–`String`ï¼‰

åœ¨æ‰§è¡Œ`ToPrimitive(goal,preferredType)`æ—¶å¦‚æœç¬¬äºŒä¸ªå‚æ•°ä¸ºç©ºå¹¶ä¸”`goal`ä¸º`Date`çš„äº‹ä¾‹æ—¶ï¼Œæ­¤æ—¶`preferredType`ä¼šè¢«è®¾ç½®ä¸º`String`ï¼Œå…¶ä»–æƒ…å†µä¸‹`preferredType`éƒ½ä¼šè¢«è®¾ç½®ä¸º`Number`

å¦‚æœ`preferredType`ä¸º`Number`ï¼Œ`ToPrimitive`æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼š

1. å¦‚æœgoalä¸ºåŸå§‹å€¼ï¼Œç›´æ¥è¿”å›ï¼›
2. å¦åˆ™è°ƒç”¨ goal.valueOf()ï¼Œå¦‚æœæ‰§è¡Œç»“æœæ˜¯åŸå§‹å€¼ï¼Œè¿”å›ä¹‹ï¼›
3. å¦åˆ™è°ƒç”¨ goal.toString()ï¼Œå¦‚æœæ‰§è¡Œç»“æœæ˜¯åŸå§‹å€¼ï¼Œè¿”å›ä¹‹ï¼›
4. å¦åˆ™æŠ›å¼‚å¸¸ã€‚

å¦‚æœ`preferredType`ä¸º`String`ï¼Œå°†ä¸Šé¢çš„ç¬¬2æ­¥å’Œç¬¬3æ­¥è°ƒæ¢ï¼Œå³ï¼š
1. å¦‚æœgoalä¸ºåŸå§‹å€¼ï¼Œç›´æ¥è¿”å›ï¼›
2. å¦åˆ™è°ƒç”¨ goal.toString()ï¼Œå¦‚æœæ‰§è¡Œç»“æœæ˜¯åŸå§‹å€¼ï¼Œè¿”å›ä¹‹ï¼›
3. å¦åˆ™è°ƒç”¨ goal.valueOf()ï¼Œå¦‚æœæ‰§è¡Œç»“æœæ˜¯åŸå§‹å€¼ï¼Œè¿”å›ä¹‹ï¼›
4. å¦åˆ™æŠ›å¼‚å¸¸ã€‚


> goal.toString ä¸ goal.valueOf

`toString`ç”¨æ¥è¿”å›å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚
`valueOf`æ–¹æ³•è¿”å›å¯¹è±¡çš„åŸå§‹å€¼ï¼Œå¯èƒ½æ˜¯å­—ç¬¦ä¸²ã€æ•°å€¼æˆ–boolå€¼ç­‰ï¼Œçœ‹å…·ä½“çš„å¯¹è±¡ã€‚

```js
const a = { name: 'ahah' };
a.toString(); // '[object Object]'
a.valueOf(); // { name: 'ahah' }

const b = [1, 2, 4];
b.toString(); // "1,2,4"
b.valueOf(); // [1,2,4]

const date = new Date();
date.toString(); // Sun Feb 28 2016 13:40:36 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)
date.valueOf(); // 1456638436303

```

> `ToPrimitive`çš„ä¼ªä»£ç è¡¨ç¤ºï¼š

```js
const toPrimitive = (goal, preferredType='Number') => {
  let Utils = {
    typeOf: function(goal) {
      return Object.prototype.toString.call(goal).slice(8, -1);
    },
    isPrimitive: function(goal) {
      let types = ['Null', 'String', 'Boolean', 'Undefined', 'Number'];
      return types.indexOf(this.typeOf(goal)) !== -1;
    }
  };

  if (Utils.isPrimitive(goal)) {
    return goal;
  }

  preferredType = (preferredType === 'String' || Utils.typeOf(goal) === 'Date') ?
    'String' : 'Number';

  if (preferredType === 'Number') {
    if (Utils.isPrimitive(goal.valueOf())) {
      return goal.valueOf()
    };
    if (Utils.isPrimitive(goal.toString())) {
      return goal.toString()
    };
  } else {
    if (Utils.isPrimitive(goal.toString())) {
      return goal.toString()
    };
    if (Utils.isPrimitive(goal.valueOf())) {
      return goal.valueOf()
    };
  }
}

const a = {};
ToPrimitive(a);//"[object Object]",ä¸ä¸Šé¢æ–‡å­—åˆ†æçš„ä¸€è‡´
```

#### è§£æ`++[[]][+[]]+[+[]]`

[è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Operator_Precedence)


```js
// è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ï¼š ++ ä¼˜å…ˆçº§é«˜äº + 

// æ‹†åˆ† ++ è‡ªå¢è¿ç®—æ³•
(++[[]][+[]]) + ([+[]])

// [+[]] è§£æ

+[] // ä¸€å…ƒ+è¿ç®—ç¬¦ []ä¼šå–ToNumberçš„å€¼ [].valueOf() => [] => [].toString() => ''  => +'' => +0

[+[]] => [0]

// ++[[]][+[]] è§£æ

++[[]][+[]] => ++[[]][0]


// è¿ç®—ç¬¦çš„ä¼˜é€‰çº§ å±æ€§è®¿é—®å™¨ï¼ˆæ•°ç»„å–ä¸‹æ ‡ï¼‰ä¼˜å…ˆçº§é«˜äº ++

[[]][0] => []

++[[]][0] => ++[]

// å˜å½¢å¼ï¼š

++[[]][+[]]+[+[]] => ++[] + [0]
```

> é—®é¢˜ï¼š

`++[[]][0]`åœ¨æµè§ˆå™¨ä¸æŠ¥é”™`++[]`åœ¨æµè§ˆå™¨æŠ¥é”™äº†.

`++[]`: `Uncaught SyntaxError: Invalid left-hand side expression in prefix operation `

[å‰ç¼€è‡ªå¢è¿ç®—ç¬¦è§„èŒƒ](https://262.ecma-international.org/5.1/#sec-11.4.4)

> `a++`å…ˆèµ‹å€¼ï¼Œåè‡ªå¢
> `++a`å…ˆè‡ªå¢ï¼Œåèµ‹å€¼

å…³é”®`Call PutValue(expr, newValue).`

`[[]][0]`æ˜¯å¯¹è±¡çš„å±æ€§è®¿é—®ï¼Œè€Œæˆ‘ä»¬çŸ¥é“å¯¹è±¡çš„å±æ€§è®¿é—®è¿”å›çš„æ˜¯å¼•ç”¨ï¼Œæ‰€ä»¥å¯ä»¥æ­£ç¡®æ‰§è¡Œã€‚

`++[]` => [] + 1 => 1 (Number)

`++[[]][+[]]+[+[]]` => 1 + [0];

[0].valueOf() => [0] => [0].toString() => '0'

`++[[]][+[]]+[+[]]` => 1 + '0' => '10'


#### Automatic Semicolon Insertion(ASI - è‡ªåŠ¨åˆ†å·(;)æ’å…¥æœºåˆ¶)

[JavaScript è¯­å¥ååº”è¯¥åŠ åˆ†å·ä¹ˆï¼Ÿ](https://www.zhihu.com/question/20298345)

çœŸæ­£ä¼šå¯¼è‡´ä¸Šä¸‹è¡Œè§£æå‡ºé—®é¢˜çš„`token`æœ‰ 5 ä¸ªï¼šæ‹¬å·ï¼Œæ–¹æ‹¬å·ï¼Œæ­£åˆ™å¼€å¤´çš„æ–œæ ï¼ŒåŠ å·ï¼Œå‡å·ã€‚

```js
  // ğŸŒ°ä¾‹å­1
  function fn1() {
    return
    {
      a: 1
    }
  }

  var a1 = fn()1; // undefined

  // ğŸŒ°ä¾‹å­2
  function fn2() {
    return { a: 1 }
  }

  var a2 = fn2(); // { a: 1 }
```

[ASIè§„èŒƒ1](https://tc39.es/ecma262/#sec-automatic-semicolon-insertion)
[ASIè§„èŒƒ2](https://262.ecma-international.org/5.1/#sec-7.9)


> æ€»ç»“ASIçš„è§„åˆ™

1. æ–°è¡Œå¹¶å…¥å½“å‰è¡Œå°†æ„æˆéæ³•è¯­å¥ï¼Œè‡ªåŠ¨æ’å…¥åˆ†å·ã€‚

```js
if(1 < 10) a = 1
console.log(a)
// ç­‰ä»·äº
if(1 < 10) a = 1;
console.log(a);
```
2. åœ¨`continue`,`return`,`break`,`throw`åè‡ªåŠ¨æ’å…¥åˆ†å·

```js
return
{a: 1}
// ç­‰ä»·äº
return;
{a: 1};
```

3. `++`ã€`--`åç¼€è¡¨è¾¾å¼ä½œä¸ºæ–°è¡Œçš„å¼€å§‹ï¼Œåœ¨è¡Œé¦–è‡ªåŠ¨æ’å…¥åˆ†å·

```js
a
++
c
// ç­‰ä»·äº
a;
++c;
```

4. ä»£ç å—çš„æœ€åä¸€ä¸ªè¯­å¥ä¼šè‡ªåŠ¨æ’å…¥åˆ†å·

```js
function(){ a = 1 }
// ç­‰ä»·äº
function(){ a = 1; }
```

> No ASIçš„è§„åˆ™

1. æ–°è¡Œä»¥(å¼€å§‹

```js
var a = 1
var b = a
(a+b).toString()
// ä¼šè¢«è§£æä¸ºä»¥a+bä¸ºå…¥å‚è°ƒç”¨å‡½æ•°aï¼Œç„¶åè°ƒç”¨å‡½æ•°è¿”å›å€¼çš„toStringå‡½æ•°
var a = 1
var b =a(a+b).toString()
```

2. æ–°è¡Œä»¥ [ å¼€å§‹

```js
var a = ['a1', 'a2']
var b = a
[0,1].slice(1)
// ä¼šè¢«è§£æå…ˆè·å–a[1]ï¼Œç„¶åè°ƒç”¨a[1].slice(1)ã€‚
// ç”±äºé€—å·ä½äº[]å†…ï¼Œä¸”ä¸è¢«è§£æä¸ºæ•°ç»„å­—é¢é‡ï¼Œè€Œè¢«è§£æä¸ºè¿ç®—ç¬¦ï¼Œè€Œé€—å·è¿ç®—ç¬¦ä¼šå…ˆæ‰§
// è¡Œå·¦ä¾§è¡¨è¾¾å¼ï¼Œç„¶åæ‰§è¡Œå³ä¾§è¡¨è¾¾å¼å¹¶ä¸”ä»¥å³ä¾§è¡¨è¾¾å¼çš„è®¡ç®—ç»“æœä½œä¸ºè¿”å›å€¼
var a = ['a1', 'a2']
var b = a[0,1].slice(1)
```

3. æ–°è¡Œä»¥ / å¼€å§‹

```js
var a = 1
var b = a
/test/.test(b)
// /ä¼šè¢«è§£æä¸ºæ•´é™¤è¿ç®—ç¬¦ï¼Œè€Œä¸æ˜¯æ­£åˆ™è¡¨è¾¾å¼å­—é¢é‡çš„èµ·å§‹ç¬¦å·ã€‚æµè§ˆå™¨ä¸­ä¼šæŠ¥testå‰å¤šäº†ä¸ª.å·
var a = 1
var b = a / test / .test(b)
```

4. æ–°è¡Œä»¥ + ã€ - ã€ % å’Œ * å¼€å§‹

```js
var a = 2
var b = a
+a
// ä¼šè§£æå¦‚ä¸‹æ ¼å¼
var a = 2
var b = a + a
```

5. æ–°è¡Œä»¥ , æˆ– . å¼€å§‹

```js
var a = 2
var b = a
.toString()
console.log(typeof b)
// ä¼šè§£æä¸º
var a = 2
var b = a.toString()
console.log(typeof b)
```

#### æµè§ˆå™¨å¯¹`{}`çš„è§£æ

> JavaScriptå¼•æ“æ˜¯å¦‚ä½•åˆ¤æ–­`{}`æ˜¯ä»£ç å—è¿˜æ˜¯å¯¹è±¡çš„ï¼Ÿ

> JavaScriptçš„è¯­å¥ä¸åŸå§‹è¡¨è¾¾å¼

```js
  // chromeçš„ç»“æœ
  1. { a: 1} // { a: 1 }
  2. { a: 1 }; // 1
  3. { a: 1 } + 1 // 1

  // Firefoxçš„ç»“æœ
  1. { a: 1 } // 1
  2. { a: 1 }; // 1
  3. { a: 1 } + 1 // 1
```

#### æŠ½è±¡ç›¸ç­‰çš„æ¯”è¾ƒç®—æ³• (==)

> é¢˜ç›®

```js
1. [] == [] // false => {} == {} // false
2. [] == ![] // true => Number([]): 0, ![]: false => 0 == false // true
3. {} == !{} // false => Number({}): NaN, !{}: false => NaN == false // false
4. {} == ![] // æŠ¥é”™ ï¼šUncaught SyntaxError: Unexpected token '=='
5. ![] == {} // false => ![]: false, Number({}): NaN => false == NaN // false
6. [] == !{} // true => Number([]): 0 , !{}: false => 0 == false // true
7. undefined == null // true
```

> çœ‹è§„èŒƒ

[é€»è¾‘é!](https://262.ecma-international.org/5.1/#sec-11.4.9)

![image](https://user-images.githubusercontent.com/25894364/126450168-7618655c-adc7-4799-bf0c-dc86995b9baf.png)

*******************

[== ç›¸ç­‰](https://262.ecma-international.org/5.1/#sec-11.9.3)

![image](https://user-images.githubusercontent.com/25894364/126449300-dd21833d-7425-4bde-a51c-5fa49d02c8f9.png)


> ä¸€é“é¢˜: `a == 1 && a == 2 && a == 3`è¾“å‡ºç»“æœä¸º`true`çš„æ–¹æ³•ã€‚

```js
const a = {
  value: 1,
  valueOf: function() {
    return this.value ++;
  }
};

a == 1 && a == 2 && a == 3 // true
```

> `x == y`: Return true if `x` and `y` refer to the **same object**. Otherwise, return false.

å¼•ç”¨ç±»å‹æŒ‡å‘åŒæ ·çš„å¼•ç”¨åœ°å€ => same object


#### ä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦(===)

[===ç›¸ç­‰](https://262.ecma-international.org/5.1/#sec-11.9.6)

![image](https://user-images.githubusercontent.com/25894364/126454534-89b9f59d-523d-4e6b-a1b3-5a1a05309109.png)

#### å‚è€ƒæ–‡ç« 

[ä»++[[]][+[]]+[+[]]==10?æ·±å…¥æµ…å‡ºå¼±ç±»å‹JSçš„éšå¼è½¬æ¢](https://github.com/jawil/blog/issues/5)

[ä» []==![] ä¸ºtrueæ¥å‰–æJavaScriptå„ç§ç±»å‹è½¬æ¢](https://github.com/jawil/blog/issues/1)
