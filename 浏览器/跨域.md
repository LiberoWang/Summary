### 同源策略
- 协议相同
- 郁闷相同
- 端口相同

#### 为什么会有跨域 - 为了安全上网

 - 保证了非同源网站的cookie, localStorage, indexedDB
 - 保证了非同源网页的DOM(iframe) 
 - 保证了非同源网站发送的Ajax或者fetch请求(可以发送，但是拒绝接受响应)

### 浏览器跨域的解决方案

#### CORS(跨域资源共享)

对于开发者来说，CORS通信与普通的AJAX通信没有区别，浏览器一旦发现是AJAX请求跨域，就会自动添加一些附加的头信息，有时还会多出一次请求。因此，实现CORS的关键是服务器，只要服务器实现了CORS的接口，就可以跨域通信了。

> 简单请求

 - 请求方法是: GET、POST、HEADE
 - HTTP消息头不超过一下字段：

 Accept
 Accept-Language
 Content-Language
 Content-Type: application/x-www-form-urlencoded、multipart/form-data、text/plain

> 非简单请求

 - 请求头是： PUT、DELETE
 - Content-Type: application/json

 通常会在发起正式通信之前，使用`OPPOTION`方法发起一个预检。

 [为什么会出现简单请求和复杂请求](https://www.zhihu.com/question/268998684/answer/344949204)
#### JSONP

JSONP的原理是利用`<script>`或者`img`标签的src属性是没有跨域的限制的，通过指向一个需要访问的地址，由服务端返回一个预先定义好的javascript函数的调用，并将服务器数据以该函数的参数的形式传递过来，此方法需要前后端配合。

且JSONP的方式只能用于`GET`请求，不支持`POST`请求

JSONP方式跨域，会不受同源正常的影响，并且携带跨域域名的`Cookies`。

#### 服务器代理

一般我们在本地环境开发的时候，就是使用`webpack-dev-server`在本地开启一个服务器代理访问

#### document.domain

该形式只能访问二级域名相同的，比如`a.test.com`和`b.test.com`，只要给两个页面添加`document.domai n= test.com`通过`a.test.com`创建一个`iframe`去控制`iframe`的`window`进行交互。

#### postMessage

`window.postMessage`是HTML5的一个api，运行两个窗口直接进行跨域发送信息。

这种方式通常是获取嵌入式页面的中第三方的数据。一个页面发送数据另一个页面判断来源接收数据。








